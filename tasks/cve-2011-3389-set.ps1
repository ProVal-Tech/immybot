Invoke-ImmyCommand -ScriptBlock {
    $rootPath = 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols'
    $targetPaths = 'SSL 3.0\Server', 'SSL 3.0\Client', 'TLS 1.0\Server', 'TLS 1.0\Client'

    $targetPaths | ForEach-Object {
        $path = Join-Path -Path $rootPath -ChildPath $_
        if (!(Test-Path -Path $path)) {
            New-Item -Path $path -Force
        }
        New-ItemProperty `
            -Path $path `
            -Name 'Enabled' `
            -Value 0 `
            -PropertyType DWORD `
            -Force

        New-ItemProperty `
            -Path $path `
            -Name 'DisabledByDefault' `
            -Value 1 `
            -PropertyType DWORD `
            -Force
    }
}