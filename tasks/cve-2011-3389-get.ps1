Invoke-ImmyCommand -ScriptBlock {
    $rootPath = 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols'
    $targetPaths = 'SSL 3.0\Server', 'SSL 3.0\Client', 'TLS 1.0\Server', 'TLS 1.0\Client'    
    $list = [System.Collections.Generic.List[psobject]]::new()
    $targetPaths | ForEach-Object {
        $path = "$rootPath\$_"
        $list.Add(
            [PSCustomObject]@{
                Path = $path
                Enabled = (Get-ItemProperty -Path $path -Name 'Enabled' -ErrorAction SilentlyContinue).Enabled
                DisabledByDefault = (Get-ItemProperty -Path $path -Name 'DisabledByDefault' -ErrorAction SilentlyContinue).DisabledByDefault
            }
        )
    }
    return $list | ConvertTo-Json
}